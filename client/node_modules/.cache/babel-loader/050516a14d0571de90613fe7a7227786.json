{"ast":null,"code":"/*\nSong: LAKEY INSPIRED - Chill Day (Vlog No Copyright Music) Music provided by Vlog No Copyright Music. Video Link: https://youtu.be/vtHGESuQ22s\n*/\n//---\nvar audio, audioContext, audioSrc;\nvar analyser, analyserBufferLength;\nvar audioInfo = 'Song: LAKEY INSPIRED - Chill Day'; //---\n\nvar MATHPI2 = Math.PI * 2; //---\n\nvar w;\nvar h;\nvar btStart;\nvar btLoadAudio;\nvar labelLoadAudio;\nvar txtStatus;\nvar canvas;\nvar context;\nvar imageData;\nvar data;\nvar mouseActive = false;\nvar mouseDown = false;\nvar mousePos = {\n  x: 0,\n  y: 0\n};\nvar fov = 250;\nvar speed = 0.75; //0.25;\n\nvar cubeMinHeight = 2;\nvar frequencyDamp = 25;\nvar smoothingTimeConstant = 0.65;\nvar fftSize = 8192; //32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768\n\nvar circleHolder = [];\nvar time = 0;\nvar colorInvertValue = 0;\nvar rgb = {};\nrgb.r = Math.random() * MATHPI2;\nrgb.g = Math.random() * MATHPI2;\nrgb.b = Math.random() * MATHPI2;\nvar rgb2 = {};\nrgb2.r = Math.random() * MATHPI2;\nrgb2.g = Math.random() * MATHPI2;\nrgb2.b = Math.random() * MATHPI2; //---\n\n/*\nfunction getRGBColor() {\n\n  var r = Math.sin( rgb.r += 0.010 ) * 1 + 1;\n  var g = Math.sin( rgb.g += 0.007 ) * 1 + 1;\n  var b = Math.sin( rgb.b += 0.013 ) * 1 + 1;\n  //var r = Math.sin( rgb.r += 0.040 ) * 1 + 1;\n  //var g = Math.sin( rgb.g += 0.028 ) * 1 + 1;\n  //var b = Math.sin( rgb.b += 0.052 ) * 1 + 1;\n\n  return { r:r, g:g, b:b };\n\n};*/\n\nfunction getRGBColor(color) {\n  var r = Math.sin(color.r += 0.010) * 1 + 1;\n  var g = Math.sin(color.g += 0.007) * 1 + 1;\n  var b = Math.sin(color.b += 0.013) * 1 + 1; //var r = Math.sin( color.r += 0.040 ) * 1 + 1;\n  //var g = Math.sin( color.g += 0.028 ) * 1 + 1;\n  //var b = Math.sin( color.b += 0.052 ) * 1 + 1;\n\n  return {\n    r: r,\n    g: g,\n    b: b\n  };\n}\n\n;\n\nfunction getRGBColor2(color) {\n  //var r = Math.sin( color.r += 0.010 ) * 1 + 1;\n  //var g = Math.sin( color.g += 0.007 ) * 1 + 1;\n  //var b = Math.sin( color.b += 0.013 ) * 1 + 1;\n  var r = Math.sin(color.r += 0.040) * 1 + 1;\n  var g = Math.sin(color.g += 0.028) * 1 + 1;\n  var b = Math.sin(color.b += 0.052) * 1 + 1;\n  return {\n    r: r,\n    g: g,\n    b: b\n  };\n}\n\n;\n\nfunction limitRGBColor(color, percent = 0.45) {\n  if (color.r < percent) {\n    color.r = percent;\n  }\n\n  if (color.g < percent) {\n    color.g = percent;\n  }\n\n  if (color.b < percent) {\n    color.b = percent;\n  }\n}\n\n;\n\nfunction init() {\n  canvas = document.createElement('canvas');\n  canvas.addEventListener('mousedown', mouseDownHandler, false);\n  canvas.addEventListener('mouseup', mouseUpHandler, false);\n  canvas.addEventListener('mousemove', mouseMoveHandler, false);\n  canvas.addEventListener('mouseenter', mouseEnterHandler, false);\n  canvas.addEventListener('mouseleave', mouseLeaveHandler, false);\n  document.body.appendChild(canvas);\n  context = canvas.getContext('2d');\n  window.addEventListener('resize', onResize, false);\n  onResize();\n  addCircles();\n  render();\n  clearImageData();\n  render();\n  context.putImageData(imageData, 0, 0);\n  btStart = document.getElementById('btStartAudioVisualization');\n  btStart.addEventListener('mousedown', userStart, false);\n  btLoadAudio = document.getElementById('btLoadAudio');\n  btLoadAudio.addEventListener('change', loadAudioFileHandler, false);\n  labelLoadAudio = document.getElementById('labelLoadAudio');\n  labelLoadAudio.style.display = 'none';\n  txtStatus = document.getElementById('txtStatus');\n  txtStatus.innerHTML = 'Waiting Patiently For You... Please Click the Start Button.';\n}\n\n; //---\n\nfunction userStart() {\n  btStart.removeEventListener('mousedown', userStart);\n  btStart.addEventListener('mousedown', audioBtHandler, false);\n  btStart.innerHTML = 'Pause Audio';\n  btStart.style.display = 'none';\n  txtStatus.innerHTML = 'Loading Audio...';\n  audioSetup('http://nkunited.de/ExternalImages/jsfiddle/audio/ChillDay_comp.mp3');\n  animate();\n}\n\n; //---\n\nfunction audioSetup(url) {\n  if (audio) {\n    audio.pause();\n  }\n\n  audio = new Audio();\n  audio.src = url;\n  audio.controls = false;\n  audio.loop = true;\n  audio.autoplay = true;\n  audio.crossOrigin = 'anonymous';\n  audio.addEventListener('canplaythrough', audioLoaded, false);\n  audioContext = new (window.AudioContext || window.webkitAudioContext)();\n  analyser = audioContext.createAnalyser();\n  analyser.connect(audioContext.destination);\n  analyser.smoothingTimeConstant = smoothingTimeConstant;\n  analyser.fftSize = fftSize;\n  analyserBufferLength = analyser.frequencyBinCount;\n  audioSrc = audioContext.createMediaElementSource(audio);\n  audioSrc.connect(analyser);\n  console.log(analyser);\n}\n\n;\n\nfunction audioLoaded(e) {\n  txtStatus.innerHTML = audioInfo;\n  btStart.style.display = 'inline-block';\n  labelLoadAudio.style.display = 'inline-block';\n}\n\n;\n\nfunction loadAudioFileHandler(e) {\n  loadFile(e);\n}\n\n;\n\nfunction loadFile(e) {\n  var input = e.target;\n  var reader = new FileReader();\n  audioInfo = input.files[0].name;\n  audioSetup(URL.createObjectURL(input.files[0]));\n}\n\n; //---\n\nfunction clearImageData() {\n  for (var i = 0, l = data.length; i < l; i += 4) {\n    data[i] = 0;\n    data[i + 1] = 0;\n    data[i + 2] = 0;\n    data[i + 3] = 255;\n  }\n}\n\n;\n\nfunction setPixel(x, y, r, g, b, a) {\n  var i = (x + y * imageData.width) * 4;\n  data[i] = r;\n  data[i + 1] = g;\n  data[i + 2] = b;\n  data[i + 3] = a;\n}\n\n; //---\n\nfunction drawLine(x1, y1, x2, y2, r, g, b, a) {\n  var dx = Math.abs(x2 - x1);\n  var dy = Math.abs(y2 - y1);\n  var sx = x1 < x2 ? 1 : -1;\n  var sy = y1 < y2 ? 1 : -1;\n  var err = dx - dy;\n  var lx = x1;\n  var ly = y1;\n\n  while (true) {\n    if (lx > 0 && lx < w && ly > 0 && ly < h) {\n      setPixel(lx, ly, r, g, b, a);\n    }\n\n    if (lx === x2 && ly === y2) break;\n    var e2 = 2 * err;\n\n    if (e2 > -dx) {\n      err -= dy;\n      lx += sx;\n    }\n\n    if (e2 < dy) {\n      err += dx;\n      ly += sy;\n    }\n  }\n}\n\n; //---\n\nfunction getCirclePosition(centerX, centerY, radius, index, segments) {\n  var angle = index * (MATHPI2 / segments) + time;\n  var x = centerX + Math.cos(angle) * radius;\n  var y = centerY + Math.sin(angle) * radius;\n  return {\n    x: x,\n    y: y\n  };\n}\n\n;\n\nfunction drawCircle(centerPosition, radius, segments) {\n  var coordinates = [];\n  var radiusSave;\n  var diff = 0; //Math.floor( Math.random() * segments );\n\n  for (var i = 0; i <= segments; i++) {\n    //var radiusRandom = radius + Math.random() * ( radius / 8 );\n    //var radiusRandom = radius + Math.random() * ( radius / 32 );\n    var radiusRandom = radius; // + ( radius / 8 );\n\n    if (i === 0) {\n      radiusSave = radiusRandom;\n    }\n\n    if (i === segments) {\n      radiusRandom = radiusSave;\n    }\n\n    var centerX = centerPosition.x;\n    var centerY = centerPosition.y;\n    var position = getCirclePosition(centerX, centerY, radiusRandom, i, segments);\n    coordinates.push({\n      x: position.x,\n      y: position.y,\n      index: i + diff,\n      radius: radiusRandom,\n      segments: segments\n    });\n  }\n\n  return coordinates;\n}\n\n;\n\nfunction addCircleSegment(x, y, z, audioBufferIndex) {\n  var circleSegment = {};\n  circleSegment.x = x;\n  circleSegment.y = y; //circleSegment.z = z;\n\n  circleSegment.x2d = 0;\n  circleSegment.y2d = 0;\n  circleSegment.audioBufferIndex = audioBufferIndex;\n  return circleSegment;\n}\n\n;\n\nfunction addCircles() {\n  var audioBufferIndexMin = 8;\n  var audioBufferIndexMax = 1024;\n  var audioBufferIndex = audioBufferIndexMin;\n  var centerPosition = {\n    x: 0,\n    y: 0\n  };\n  var center = {\n    x: 0,\n    y: 0\n  };\n  var toggle = 1;\n  var index = 0;\n  var audioIndex = audioBufferIndexMin;\n  var mp = {\n    x: Math.random() * w,\n    y: Math.random() * h\n  };\n\n  for (var z = -fov; z < fov; z += 5) {\n    var coordinates = drawCircle(centerPosition, 75, 64);\n    var circleObj = {};\n    circleObj.segmentsOutside = [];\n    circleObj.segmentsInside = [];\n    circleObj.segmentsInside2 = [];\n    circleObj.segmentsCount = 0;\n    circleObj.index = index; //circleObj.audioIndex = audioIndex;\n\n    circleObj.z = z;\n    circleObj.center = center;\n    circleObj.circleCenter = {\n      x: 0,\n      y: 0\n    };\n    circleObj.mp = {\n      x: mp.x,\n      y: mp.y\n    };\n    circleObj.radius = coordinates[0].radius; //circleObj.radiusAudio = circleObj.radius;\n\n    circleObj.color = {\n      r: 0,\n      g: 0,\n      b: 0\n    }; //toggle = index % 4;\n\n    toggle = index % 2;\n    index++;\n\n    if (z < 0) {\n      audioIndex++;\n    } else {\n      audioIndex--;\n    }\n\n    audioBufferIndex = Math.floor(Math.random() * audioBufferIndexMax) + audioBufferIndexMin; //audioBufferIndex = audioBufferIndexMin;\n\n    var circleSegmentOutside;\n\n    for (var i = 0, l = coordinates.length; i < l; i++) {\n      var coordinate = coordinates[i]; //if ( i % 4 === toggle && i % 2 === 1 ) {\n\n      if (i % 2 === toggle) {\n        circleSegmentOutside = addCircleSegment(coordinate.x, coordinate.y, z, audioBufferIndex);\n        circleSegmentOutside.active = true;\n        circleSegmentOutside.index = coordinate.index;\n        circleSegmentOutside.radius = coordinate.radius;\n        circleSegmentOutside.radiusAudio = circleSegmentOutside.radius; // + Math.random() * 15;\n\n        circleSegmentOutside.segments = coordinate.segments;\n        circleSegmentOutside.coordinates = [];\n        var co;\n\n        if (i > 0) {\n          co = coordinates[i - 1];\n        } else {\n          co = coordinates[l - 1];\n        }\n\n        var sub1 = addCircleSegment(co.x, co.y, z, audioBufferIndex);\n        var sub2 = addCircleSegment(coordinate.x, coordinate.y, z - 5, audioBufferIndex);\n        var sub3 = addCircleSegment(co.x, co.y, z - 5, audioBufferIndex);\n        var sub4 = addCircleSegment(coordinate.x, coordinate.y, z, audioBufferIndex);\n        var sub5 = addCircleSegment(co.x, co.y, z, audioBufferIndex);\n        var sub6 = addCircleSegment(coordinate.x, coordinate.y, z - 5, audioBufferIndex);\n        var sub7 = addCircleSegment(co.x, co.y, z - 5, audioBufferIndex);\n        sub1.index = co.index;\n        sub2.index = coordinate.index;\n        sub3.index = co.index;\n        sub4.index = coordinate.index;\n        sub5.index = co.index;\n        sub6.index = coordinate.index;\n        sub7.index = co.index;\n        circleSegmentOutside.subs = [];\n        circleSegmentOutside.subs.push(sub1, sub2, sub3, sub4, sub5, sub6, sub7); //audioBufferIndex = Math.floor( Math.random() * audioBufferIndexMax ) + audioBufferIndexMin;\n\n        if (i < l - 1) {\n          audioBufferIndex = Math.floor(Math.random() * audioBufferIndexMax) + audioBufferIndexMin;\n        } else {\n          audioBufferIndex = circleObj.segmentsOutside[0].audioBufferIndex;\n        }\n\n        circleObj.segmentsOutside.push(circleSegmentOutside);\n      } else {\n        circleObj.segmentsOutside.push({\n          active: false\n        });\n      }\n    }\n\n    circleHolder.push(circleObj);\n  }\n}\n\n; //---\n\nfunction onResize() {\n  w = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n  h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n  canvas.width = w;\n  canvas.height = h;\n  context.fillStyle = '#000000';\n  context.fillRect(0, 0, w, h);\n  imageData = context.getImageData(0, 0, w, h);\n  data = imageData.data;\n}\n\n; //---\n\nfunction audioBtHandler(event) {\n  if (audio.paused) {\n    audio.play();\n    btStart.innerHTML = 'Pause Audio';\n  } else {\n    audio.pause();\n    btStart.innerHTML = 'Play Audio';\n  }\n}\n\n; //---\n\nfunction mouseDownHandler(event) {\n  mouseDown = true;\n}\n\n;\n\nfunction mouseUpHandler(event) {\n  mouseDown = false;\n}\n\n;\n\nfunction mouseEnterHandler(event) {\n  mouseActive = true;\n}\n\n;\n\nfunction mouseLeaveHandler(event) {\n  mouseActive = false; //mousePos.x = w / 2;\n  //mousePos.y = h / 2;\n\n  mouseDown = false;\n}\n\n;\n\nfunction mouseMoveHandler(event) {\n  mousePos = getMousePos(canvas, event);\n}\n\n;\n\nfunction getMousePos(canvas, event) {\n  var rect = canvas.getBoundingClientRect();\n  return {\n    x: event.clientX - rect.left,\n    y: event.clientY - rect.top\n  };\n}\n\n; //---\n\nfunction render() {\n  var aa = false;\n\n  if (analyser) {\n    aa = true;\n  }\n\n  var frequencySource;\n\n  if (aa === true) {\n    frequencySource = new Uint8Array(analyser.frequencyBinCount);\n    analyser.getByteFrequencyData(frequencySource);\n  } //---\n\n\n  var sortArray = false; //---\n\n  var col = getRGBColor2(rgb);\n  var col2 = getRGBColor(rgb2);\n  limitRGBColor(col, 0.45);\n  limitRGBColor(col2, 0.25); //---\n\n  for (var i = 0, l = circleHolder.length; i < l; i++) {\n    var circleObj = circleHolder[i];\n    circleObj.color.r = col.r - (circleObj.z + fov) / fov;\n    circleObj.color.g = col.g - (circleObj.z + fov) / fov;\n    circleObj.color.b = col.b - (circleObj.z + fov) / fov; //circleObj.color.r = Math.floor( ( ( ( col.r - circleObj.z + fov ) ) + ( col2.r - circleObj.z + fov ) ) / 2 );\n    //circleObj.color.g = Math.floor( ( ( ( col.g - circleObj.z + fov ) ) + ( col2.g - circleObj.z + fov ) ) / 2 );\n    //circleObj.color.b = Math.floor( ( ( ( col.b - circleObj.z + fov ) ) + ( col2.b - circleObj.z + fov ) ) / 2 );\n\n    if (circleObj.color.r < col2.r) {\n      circleObj.color.r = col2.r;\n    }\n\n    if (circleObj.color.g < col2.g) {\n      circleObj.color.g = col2.g;\n    }\n\n    if (circleObj.color.b < col2.b) {\n      circleObj.color.b = col2.b;\n    }\n\n    var circleObjBack;\n\n    if (i > 0) {\n      circleObjBack = circleHolder[i - 1];\n    } //---\n\n\n    if (mouseActive) {\n      circleObj.mp = mousePos;\n    } else {\n      circleObj.mp.x += (w / 2 - circleObj.mp.x) * 0.00025;\n      circleObj.mp.y += (h / 2 - circleObj.mp.y) * 0.00025;\n    } //circleObj.center.x = ( ( w / 2 ) - circleObj.mp.x ) * ( -i / 150 ) + w / 2;\n    //circleObj.center.y = ( ( h / 2 ) - circleObj.mp.y ) * ( -i / 150 ) + h / 2;\n\n\n    circleObj.center.x = (w / 2 - circleObj.mp.x) * ((circleObj.z - fov) / 500) + w / 2;\n    circleObj.center.y = (h / 2 - circleObj.mp.y) * ((circleObj.z - fov) / 500) + h / 2; //---\n\n    if (aa === true) {} //var f = frequencySource[ Math.floor(circleObj.z + fov) ];\n    //var f = frequencySource[ i ];\n    //var f = frequencySource[ circleObj.audioIndex ];\n    //var fAdd = (f / 25);// * ( (circleObj.z - fov) / 200 );\n    //circleObj.radiusAudio = fAdd;\n    //---\n\n\n    for (var j = 0, k = circleObj.segmentsOutside.length; j < k; j++) {\n      var circleSegmentOutside = circleObj.segmentsOutside[j];\n\n      if (circleSegmentOutside.active === true) {\n        //---\n        var scale = fov / (fov + circleObj.z);\n        var scaleBack;\n\n        if (i > 0) {\n          scaleBack = fov / (fov + circleObjBack.z);\n        }\n\n        var frequency, frequencyAdd;\n        circleSegmentOutside.x2d = circleSegmentOutside.x * scale + circleObj.center.x;\n        circleSegmentOutside.y2d = circleSegmentOutside.y * scale + circleObj.center.y; //---\n\n        if (aa === true) {\n          frequency = frequencySource[circleSegmentOutside.audioBufferIndex];\n          frequencyAdd = frequency / 20; //---\n\n          circleSegmentOutside.radiusAudio = circleSegmentOutside.radius - frequencyAdd;\n        } //---\n\n\n        var lineColorValue = 0;\n\n        if (j > 0) {\n          if (aa === true && audio.paused === false) {\n            lineColorValue = Math.round(i / l * (55 + frequency)); //255\n\n            if (lineColorValue > 255) {\n              lineColorValue = 255;\n            }\n          } else {\n            lineColorValue = Math.round(i / l * 200); //255\n          }\n        } //---\n\n\n        if (i > 0 && i < l - 1) {\n          var sub1 = circleSegmentOutside.subs[0];\n          var sub1angle = sub1.index * (MATHPI2 / circleSegmentOutside.segments) + time;\n          sub1.x2d = sub1.x * scale + circleObj.center.x;\n          sub1.y2d = sub1.y * scale + circleObj.center.y;\n          sub1.x = circleObj.circleCenter.x + Math.cos(sub1angle) * circleSegmentOutside.radiusAudio;\n          sub1.y = circleObj.circleCenter.y + Math.sin(sub1angle) * circleSegmentOutside.radiusAudio;\n          var sub2 = circleSegmentOutside.subs[1];\n          var sub2angle = sub2.index * (MATHPI2 / circleSegmentOutside.segments) + time;\n          sub2.x2d = sub2.x * scaleBack + circleObjBack.center.x;\n          sub2.y2d = sub2.y * scaleBack + circleObjBack.center.y;\n          sub2.x = circleObj.circleCenter.x + Math.cos(sub2angle) * circleSegmentOutside.radiusAudio;\n          sub2.y = circleObj.circleCenter.y + Math.sin(sub2angle) * circleSegmentOutside.radiusAudio;\n          var sub3 = circleSegmentOutside.subs[2];\n          var sub3angle = sub3.index * (MATHPI2 / circleSegmentOutside.segments) + time;\n          sub3.x2d = sub3.x * scaleBack + circleObjBack.center.x;\n          sub3.y2d = sub3.y * scaleBack + circleObjBack.center.y;\n          sub3.x = circleObj.circleCenter.x + Math.cos(sub3angle) * circleSegmentOutside.radiusAudio;\n          sub3.y = circleObj.circleCenter.y + Math.sin(sub3angle) * circleSegmentOutside.radiusAudio;\n          var sub4 = circleSegmentOutside.subs[3];\n          var sub4angle = sub4.index * (MATHPI2 / circleSegmentOutside.segments) + time;\n          sub4.x2d = sub4.x * scale + circleObj.center.x;\n          sub4.y2d = sub4.y * scale + circleObj.center.y;\n          sub4.x = circleObj.circleCenter.x + Math.cos(sub4angle) * circleSegmentOutside.radius;\n          sub4.y = circleObj.circleCenter.y + Math.sin(sub4angle) * circleSegmentOutside.radius;\n          var sub5 = circleSegmentOutside.subs[4];\n          var sub5angle = sub5.index * (MATHPI2 / circleSegmentOutside.segments) + time;\n          sub5.x2d = sub5.x * scale + circleObj.center.x;\n          sub5.y2d = sub5.y * scale + circleObj.center.y;\n          sub5.x = circleObj.circleCenter.x + Math.cos(sub5angle) * circleSegmentOutside.radius;\n          sub5.y = circleObj.circleCenter.y + Math.sin(sub5angle) * circleSegmentOutside.radius;\n          var sub6 = circleSegmentOutside.subs[5];\n          var sub6angle = sub6.index * (MATHPI2 / circleSegmentOutside.segments) + time;\n          sub6.x2d = sub6.x * scaleBack + circleObjBack.center.x;\n          sub6.y2d = sub6.y * scaleBack + circleObjBack.center.y;\n          sub6.x = circleObj.circleCenter.x + Math.cos(sub6angle) * circleSegmentOutside.radius;\n          sub6.y = circleObj.circleCenter.y + Math.sin(sub6angle) * circleSegmentOutside.radius;\n          var sub7 = circleSegmentOutside.subs[6];\n          var sub7angle = sub7.index * (MATHPI2 / circleSegmentOutside.segments) + time;\n          sub7.x2d = sub7.x * scaleBack + circleObjBack.center.x;\n          sub7.y2d = sub7.y * scaleBack + circleObjBack.center.y;\n          sub7.x = circleObj.circleCenter.x + Math.cos(sub7angle) * circleSegmentOutside.radius;\n          sub7.y = circleObj.circleCenter.y + Math.sin(sub7angle) * circleSegmentOutside.radius;\n          var p1;\n          var p2;\n          var p3;\n          var p4;\n          var p5 = circleSegmentOutside.subs[3];\n          var p6 = circleSegmentOutside.subs[4];\n          var p7 = circleSegmentOutside.subs[6];\n          var p8 = circleSegmentOutside.subs[5];\n\n          if (frequencyAdd > 0) {\n            p1 = circleSegmentOutside;\n            p2 = circleSegmentOutside.subs[1];\n            p3 = circleSegmentOutside.subs[2];\n            p4 = circleSegmentOutside.subs[0];\n          }\n\n          var cr = Math.round(circleObj.color.r * lineColorValue);\n          var cg = Math.round(circleObj.color.g * lineColorValue);\n          var cb = Math.round(circleObj.color.b * lineColorValue);\n\n          if (frequencyAdd > 0) {\n            drawLine(p1.x2d | 0, p1.y2d | 0, p2.x2d | 0, p2.y2d | 0, cr, cg, cb, 255);\n            drawLine(p2.x2d | 0, p2.y2d | 0, p3.x2d | 0, p3.y2d | 0, cr, cg, cb, 255);\n            drawLine(p3.x2d | 0, p3.y2d | 0, p4.x2d | 0, p4.y2d | 0, cr, cg, cb, 255);\n            drawLine(p4.x2d | 0, p4.y2d | 0, p1.x2d | 0, p1.y2d | 0, cr, cg, cb, 255);\n            drawLine(p5.x2d | 0, p5.y2d | 0, p1.x2d | 0, p1.y2d | 0, cr, cg, cb, 255);\n            drawLine(p6.x2d | 0, p6.y2d | 0, p4.x2d | 0, p4.y2d | 0, cr, cg, cb, 255);\n            drawLine(p7.x2d | 0, p7.y2d | 0, p3.x2d | 0, p3.y2d | 0, cr, cg, cb, 255);\n            drawLine(p8.x2d | 0, p8.y2d | 0, p2.x2d | 0, p2.y2d | 0, cr, cg, cb, 255);\n          }\n\n          if (circleObj.z < fov / 2) {\n            drawLine(p5.x2d | 0, p5.y2d | 0, p6.x2d | 0, p6.y2d | 0, cr, cg, cb, 255);\n            drawLine(p6.x2d | 0, p6.y2d | 0, p7.x2d | 0, p7.y2d | 0, cr, cg, cb, 255);\n            drawLine(p7.x2d | 0, p7.y2d | 0, p8.x2d | 0, p8.y2d | 0, cr, cg, cb, 255);\n            drawLine(p8.x2d | 0, p8.y2d | 0, p5.x2d | 0, p5.y2d | 0, cr, cg, cb, 255);\n          }\n        } //---\n\n\n        var circleSegmentOutsideangle; //if ( j < k - 1 ) {\n\n        circleSegmentOutsideangle = circleSegmentOutside.index * (MATHPI2 / circleSegmentOutside.segments) + time;\n        circleSegmentOutside.x = circleObj.circleCenter.x + Math.cos(circleSegmentOutsideangle) * circleSegmentOutside.radiusAudio;\n        circleSegmentOutside.y = circleObj.circleCenter.y + Math.sin(circleSegmentOutsideangle) * circleSegmentOutside.radiusAudio;\n        /*} else {\n           var circleSegmentOutside1 = circleObj.segmentsOutside[ 0 ];\n           circleSegmentOutsideangle = circleSegmentOutside1.index * ( MATHPI2 / circleSegmentOutside1.segments ) + time;\n           circleSegmentOutside.x = circleObj.circleCenter.x + Math.cos( circleSegmentOutsideangle ) * circleSegmentOutside1.radiusAudio;\n          circleSegmentOutside.y = circleObj.circleCenter.y + Math.sin( circleSegmentOutsideangle ) * circleSegmentOutside1.radiusAudio;\n            }\n        */\n        //---\n\n        /*\n        if ( i > 0 && i < l - 1 ) {\n        //if ( i > 0 && i < l - 1 && j < k - 1 ) {\n         var circleSegmentOutsideLineBack;// = circleObjBack[ j ];\n        var circleSegmentInsideLineBack;\n         //if ( j === 0 ) {\n           //pB = circleObjBack.segments[ circleObjBack.segments.length - 1 ];\n         //} else {\n           //pB = circleObjBack.segments[ j - 1 ];\n         //}\n         circleSegmentOutsideLineBack = circleObjBack.segmentsOutside[ j ];\n        circleSegmentInsideLineBack = circleObjBack.segmentsInside[ j ];\n         //drawLine( circleSegmentOutside.x2d | 0, circleSegmentOutside.y2d | 0, circleSegmentOutsideLineBack.x2d | 0, circleSegmentOutsideLineBack.y2d | 0, 0, Math.round( lineColorValue / 2 ), lineColorValue, 255 );\n        //drawLine( circleSegmentInside.x2d | 0, circleSegmentInside.y2d | 0, circleSegmentInsideLineBack.x2d | 0, circleSegmentInsideLineBack.y2d | 0, 0, Math.round( lineColorValue / 2 ), lineColorValue, 255 );\n        }\n        */\n      }\n    }\n\n    if (mouseDown) {\n      circleObj.z += speed;\n\n      if (circleObj.z > fov) {\n        circleObj.z -= fov * 2;\n        sortArray = true;\n      }\n    } else {\n      circleObj.z -= speed;\n\n      if (circleObj.z < -fov) {\n        circleObj.z += fov * 2;\n        sortArray = true;\n      }\n    }\n  } //---\n\n\n  if (sortArray) {\n    circleHolder = circleHolder.sort(function (a, b) {\n      return b.z - a.z;\n    });\n  } //---\n\n\n  if (mouseDown) {\n    time -= 0.005;\n  } else {\n    time += 0.005;\n  } //---\n  //soft invert colors\n\n\n  if (mouseDown) {\n    if (colorInvertValue < 255) colorInvertValue += 5;else colorInvertValue = 255;\n    softInvert(colorInvertValue);\n  } else {\n    if (colorInvertValue > 0) colorInvertValue -= 5;else colorInvertValue = 0;\n    if (colorInvertValue > 0) softInvert(colorInvertValue);\n  }\n}\n\n; //---\n\nfunction softInvert(value) {\n  for (var j = 0, n = data.length; j < n; j += 4) {\n    data[j] = Math.abs(value - data[j]); // red\n\n    data[j + 1] = Math.abs(value - data[j + 1]); // green\n\n    data[j + 2] = Math.abs(value - data[j + 2]); // blue\n\n    data[j + 3] = 255; // - data[ j + 3 ]; // alpha\n  }\n}\n\n; //---\n\nfunction animate() {\n  clearImageData();\n  render();\n  context.putImageData(imageData, 0, 0);\n  requestAnimationFrame(animate);\n}\n\n;\n\nwindow.requestAnimFrame = function () {\n  return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function (callback) {\n    window.setTimeout(callback, 1000 / 60);\n  };\n}();","map":{"version":3,"sources":["/Grawdanin/MERN/audio/src/components/AudioVizyalization/animation.js"],"names":["audio","audioContext","audioSrc","analyser","analyserBufferLength","audioInfo","MATHPI2","Math","PI","w","h","btStart","btLoadAudio","labelLoadAudio","txtStatus","canvas","context","imageData","data","mouseActive","mouseDown","mousePos","x","y","fov","speed","cubeMinHeight","frequencyDamp","smoothingTimeConstant","fftSize","circleHolder","time","colorInvertValue","rgb","r","random","g","b","rgb2","getRGBColor","color","sin","getRGBColor2","limitRGBColor","percent","init","document","createElement","addEventListener","mouseDownHandler","mouseUpHandler","mouseMoveHandler","mouseEnterHandler","mouseLeaveHandler","body","appendChild","getContext","window","onResize","addCircles","render","clearImageData","putImageData","getElementById","userStart","loadAudioFileHandler","style","display","innerHTML","removeEventListener","audioBtHandler","audioSetup","animate","url","pause","Audio","src","controls","loop","autoplay","crossOrigin","audioLoaded","AudioContext","webkitAudioContext","createAnalyser","connect","destination","frequencyBinCount","createMediaElementSource","console","log","e","loadFile","input","target","reader","FileReader","files","name","URL","createObjectURL","i","l","length","setPixel","a","width","drawLine","x1","y1","x2","y2","dx","abs","dy","sx","sy","err","lx","ly","e2","getCirclePosition","centerX","centerY","radius","index","segments","angle","cos","drawCircle","centerPosition","coordinates","radiusSave","diff","radiusRandom","position","push","addCircleSegment","z","audioBufferIndex","circleSegment","x2d","y2d","audioBufferIndexMin","audioBufferIndexMax","center","toggle","audioIndex","mp","circleObj","segmentsOutside","segmentsInside","segmentsInside2","segmentsCount","circleCenter","floor","circleSegmentOutside","coordinate","active","radiusAudio","co","sub1","sub2","sub3","sub4","sub5","sub6","sub7","subs","innerWidth","documentElement","clientWidth","innerHeight","clientHeight","height","fillStyle","fillRect","getImageData","event","paused","play","getMousePos","rect","getBoundingClientRect","clientX","left","clientY","top","aa","frequencySource","Uint8Array","getByteFrequencyData","sortArray","col","col2","circleObjBack","j","k","scale","scaleBack","frequency","frequencyAdd","lineColorValue","round","sub1angle","sub2angle","sub3angle","sub4angle","sub5angle","sub6angle","sub7angle","p1","p2","p3","p4","p5","p6","p7","p8","cr","cg","cb","circleSegmentOutsideangle","sort","softInvert","value","n","requestAnimationFrame","requestAnimFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","setTimeout"],"mappings":"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","sourcesContent":["/*\nSong: LAKEY INSPIRED - Chill Day (Vlog No Copyright Music) Music provided by Vlog No Copyright Music. Video Link: https://youtu.be/vtHGESuQ22s\n*/\n//---\n\nvar audio, audioContext, audioSrc;\nvar analyser, analyserBufferLength;\nvar audioInfo = 'Song: LAKEY INSPIRED - Chill Day';\n\n//---\n\nvar MATHPI2 = Math.PI * 2;\n\n//---\n\nvar w;\nvar h;\n\nvar btStart;\nvar btLoadAudio;\nvar labelLoadAudio;\nvar txtStatus;\nvar canvas;\nvar context;\n\nvar imageData;\nvar data;\n\nvar mouseActive = false;\nvar mouseDown = false;\nvar mousePos = { x:0, y:0 };\n\nvar fov = 250;\n\nvar speed = 0.75;//0.25;\n\nvar cubeMinHeight = 2;\n\nvar frequencyDamp = 25;\nvar smoothingTimeConstant = 0.65;\nvar fftSize = 8192;//32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768\n\nvar circleHolder = [];\n\nvar time = 0;\n\nvar colorInvertValue = 0;\n\nvar rgb = {};\nrgb.r = Math.random() * MATHPI2;\nrgb.g = Math.random() * MATHPI2;\nrgb.b = Math.random() * MATHPI2;\n\nvar rgb2 = {};\nrgb2.r = Math.random() * MATHPI2;\nrgb2.g = Math.random() * MATHPI2;\nrgb2.b = Math.random() * MATHPI2;\n\n//---\n/*\nfunction getRGBColor() {\n\n  var r = Math.sin( rgb.r += 0.010 ) * 1 + 1;\n  var g = Math.sin( rgb.g += 0.007 ) * 1 + 1;\n  var b = Math.sin( rgb.b += 0.013 ) * 1 + 1;\n  //var r = Math.sin( rgb.r += 0.040 ) * 1 + 1;\n  //var g = Math.sin( rgb.g += 0.028 ) * 1 + 1;\n  //var b = Math.sin( rgb.b += 0.052 ) * 1 + 1;\n\n  return { r:r, g:g, b:b };\n\n};*/\n\nfunction getRGBColor( color ) {\n\n    var r = Math.sin( color.r += 0.010 ) * 1 + 1;\n    var g = Math.sin( color.g += 0.007 ) * 1 + 1;\n    var b = Math.sin( color.b += 0.013 ) * 1 + 1;\n    //var r = Math.sin( color.r += 0.040 ) * 1 + 1;\n    //var g = Math.sin( color.g += 0.028 ) * 1 + 1;\n    //var b = Math.sin( color.b += 0.052 ) * 1 + 1;\n\n    return { r:r, g:g, b:b };\n\n};\n\nfunction getRGBColor2( color ) {\n\n    //var r = Math.sin( color.r += 0.010 ) * 1 + 1;\n    //var g = Math.sin( color.g += 0.007 ) * 1 + 1;\n    //var b = Math.sin( color.b += 0.013 ) * 1 + 1;\n    var r = Math.sin( color.r += 0.040 ) * 1 + 1;\n    var g = Math.sin( color.g += 0.028 ) * 1 + 1;\n    var b = Math.sin( color.b += 0.052 ) * 1 + 1;\n\n    return { r:r, g:g, b:b };\n\n};\n\nfunction limitRGBColor( color, percent = 0.45 ) {\n\n    if ( color.r < percent ) {\n\n        color.r = percent;\n\n    }\n\n    if ( color.g < percent ) {\n\n        color.g = percent;\n\n    }\n\n    if ( color.b < percent ) {\n\n        color.b = percent;\n\n    }\n\n};\n\nfunction init() {\n\n    canvas = document.createElement( 'canvas' );\n    canvas.addEventListener( 'mousedown', mouseDownHandler, false );\n    canvas.addEventListener( 'mouseup', mouseUpHandler, false );\n    canvas.addEventListener( 'mousemove', mouseMoveHandler, false );\n    canvas.addEventListener( 'mouseenter', mouseEnterHandler, false );\n    canvas.addEventListener( 'mouseleave', mouseLeaveHandler, false );\n\n    document.body.appendChild( canvas );\n\n    context = canvas.getContext( '2d' );\n\n    window.addEventListener( 'resize', onResize, false );\n\n    onResize();\n\n    addCircles();\n\n    render();\n\n    clearImageData();\n\n    render();\n\n    context.putImageData( imageData, 0, 0 );\n\n    btStart = document.getElementById( 'btStartAudioVisualization' );\n    btStart.addEventListener( 'mousedown', userStart, false );\n\n    btLoadAudio = document.getElementById( 'btLoadAudio' );\n    btLoadAudio.addEventListener( 'change', loadAudioFileHandler, false );\n\n    labelLoadAudio = document.getElementById( 'labelLoadAudio' );\n    labelLoadAudio.style.display = 'none';\n\n    txtStatus = document.getElementById( 'txtStatus' );\n    txtStatus.innerHTML = 'Waiting Patiently For You... Please Click the Start Button.';\n\n};\n\n//---\n\nfunction userStart() {\n\n    btStart.removeEventListener( 'mousedown', userStart );\n\n    btStart.addEventListener( 'mousedown', audioBtHandler, false );\n    btStart.innerHTML = 'Pause Audio';\n    btStart.style.display = 'none';\n\n    txtStatus.innerHTML = 'Loading Audio...';\n\n    audioSetup( 'http://nkunited.de/ExternalImages/jsfiddle/audio/ChillDay_comp.mp3' );\n    animate();\n\n};\n\n//---\n\nfunction audioSetup( url ) {\n\n    if ( audio ) {\n\n        audio.pause();\n\n    }\n\n    audio = new Audio();\n    audio.src = url;\n    audio.controls = false;\n    audio.loop = true;\n    audio.autoplay = true;\n    audio.crossOrigin = 'anonymous';\n    audio.addEventListener( 'canplaythrough', audioLoaded, false );\n\n    audioContext = new ( window.AudioContext || window.webkitAudioContext )();\n\n    analyser = audioContext.createAnalyser();\n    analyser.connect( audioContext.destination );\n    analyser.smoothingTimeConstant = smoothingTimeConstant;\n    analyser.fftSize = fftSize;\n    analyserBufferLength = analyser.frequencyBinCount;\n\n    audioSrc = audioContext.createMediaElementSource( audio );\n    audioSrc.connect( analyser );\n\n\n    console.log(analyser)\n\n};\n\nfunction audioLoaded( e ) {\n\n    txtStatus.innerHTML = audioInfo;\n\n    btStart.style.display = 'inline-block';\n\n    labelLoadAudio.style.display = 'inline-block';\n\n};\n\nfunction loadAudioFileHandler( e ) {\n\n    loadFile( e );\n\n};\n\nfunction loadFile( e ) {\n\n    var input = e.target;\n    var reader = new FileReader();\n\n    audioInfo = input.files[ 0 ].name;\n    audioSetup( URL.createObjectURL( input.files[ 0 ] ) );\n\n};\n\n//---\n\nfunction clearImageData() {\n\n    for ( var i = 0, l = data.length; i < l; i += 4 ) {\n\n        data[ i ] = 0;\n        data[ i + 1 ] = 0;\n        data[ i + 2 ] = 0;\n        data[ i + 3 ] = 255;\n\n    }\n\n};\n\nfunction setPixel( x, y, r, g, b, a ) {\n\n    var i = ( x + y * imageData.width ) * 4;\n\n    data[ i ] = r;\n    data[ i + 1 ] = g;\n    data[ i + 2 ] = b;\n    data[ i + 3 ] = a;\n\n};\n\n//---\n\nfunction drawLine( x1, y1, x2, y2, r, g, b, a ) {\n\n    var dx = Math.abs( x2 - x1 );\n    var dy = Math.abs( y2 - y1 );\n\n    var sx = ( x1 < x2 ) ? 1 : -1;\n    var sy = ( y1 < y2 ) ? 1 : -1;\n\n    var err = dx - dy;\n\n    var lx = x1;\n    var ly = y1;\n\n    while ( true ) {\n\n        if ( lx > 0 && lx < w && ly > 0 && ly < h ) {\n\n            setPixel( lx, ly, r, g, b, a );\n\n        }\n\n        if ( ( lx === x2 ) && ( ly === y2 ) )\n            break;\n\n        var e2 = 2 * err;\n\n        if ( e2 > -dx ) {\n\n            err -= dy;\n            lx += sx;\n\n        }\n\n        if ( e2 < dy ) {\n\n            err += dx;\n            ly += sy;\n\n        }\n\n    }\n\n};\n\n//---\n\nfunction getCirclePosition( centerX, centerY, radius, index, segments ) {\n\n    var angle = index * ( MATHPI2 / segments ) + time;\n\n    var x = centerX + Math.cos( angle ) * radius;\n    var y = centerY + Math.sin( angle ) * radius;\n\n    return { x:x, y:y };\n\n};\n\nfunction drawCircle( centerPosition, radius, segments ) {\n\n    var coordinates = [];\n\n    var radiusSave;\n\n    var diff = 0;//Math.floor( Math.random() * segments );\n\n    for ( var i = 0; i <= segments; i++ ) {\n\n        //var radiusRandom = radius + Math.random() * ( radius / 8 );\n        //var radiusRandom = radius + Math.random() * ( radius / 32 );\n        var radiusRandom = radius;// + ( radius / 8 );\n\n        if ( i === 0 ) {\n\n            radiusSave = radiusRandom;\n\n        }\n\n        if ( i === segments ) {\n\n            radiusRandom = radiusSave;\n\n        }\n\n        var centerX = centerPosition.x;\n        var centerY = centerPosition.y;\n\n        var position = getCirclePosition( centerX, centerY, radiusRandom, i, segments );\n\n        coordinates.push( { x:position.x, y:position.y, index:i + diff, radius:radiusRandom, segments:segments } );\n\n    }\n\n    return coordinates;\n\n};\n\nfunction addCircleSegment( x, y, z, audioBufferIndex ) {\n\n    var circleSegment = {};\n    circleSegment.x = x;\n    circleSegment.y = y;\n    //circleSegment.z = z;\n    circleSegment.x2d = 0;\n    circleSegment.y2d = 0;\n    circleSegment.audioBufferIndex = audioBufferIndex;\n\n    return circleSegment;\n\n};\n\nfunction addCircles() {\n\n    var audioBufferIndexMin = 8;\n    var audioBufferIndexMax = 1024;\n    var audioBufferIndex = audioBufferIndexMin;\n\n    var centerPosition = { x:0, y:0 };\n    var center  = { x:0, y:0 };\n\n    var toggle = 1;\n    var index = 0;\n    var audioIndex = audioBufferIndexMin;\n\n    var mp = { x:Math.random() * w, y:Math.random() * h };\n\n    for ( var z = -fov; z < fov; z += 5 ) {\n\n        var coordinates = drawCircle( centerPosition, 75, 64 );\n\n        var circleObj = {};\n        circleObj.segmentsOutside = [];\n        circleObj.segmentsInside = [];\n        circleObj.segmentsInside2 = [];\n        circleObj.segmentsCount = 0;\n        circleObj.index = index;\n        //circleObj.audioIndex = audioIndex;\n        circleObj.z = z;\n        circleObj.center = center;\n        circleObj.circleCenter = { x:0, y:0 };\n        circleObj.mp = { x:mp.x, y:mp.y };\n        circleObj.radius = coordinates[ 0 ].radius;\n        //circleObj.radiusAudio = circleObj.radius;\n        circleObj.color = { r:0, g:0, b:0 };\n\n        //toggle = index % 4;\n        toggle = index % 2;\n        index++;\n\n        if ( z < 0 ) {\n\n            audioIndex++;\n\n        } else {\n\n            audioIndex--;\n\n        }\n\n        audioBufferIndex = Math.floor( Math.random() * audioBufferIndexMax ) + audioBufferIndexMin;\n        //audioBufferIndex = audioBufferIndexMin;\n\n        var circleSegmentOutside;\n\n        for ( var i = 0, l = coordinates.length; i < l; i++ ) {\n\n            var coordinate = coordinates[ i ];\n\n            //if ( i % 4 === toggle && i % 2 === 1 ) {\n            if ( i % 2 === toggle ) {\n\n                circleSegmentOutside = addCircleSegment( coordinate.x, coordinate.y, z, audioBufferIndex );\n                circleSegmentOutside.active = true;\n                circleSegmentOutside.index = coordinate.index;\n                circleSegmentOutside.radius = coordinate.radius;\n                circleSegmentOutside.radiusAudio = circleSegmentOutside.radius;// + Math.random() * 15;\n                circleSegmentOutside.segments = coordinate.segments;\n                circleSegmentOutside.coordinates = [];\n\n                var co;\n\n                if ( i > 0 ) {\n\n                    co = coordinates[ i - 1 ];\n\n                } else {\n\n                    co = coordinates[ l - 1 ];\n\n                }\n\n                var sub1 = addCircleSegment( co.x, co.y, z, audioBufferIndex );\n                var sub2 = addCircleSegment( coordinate.x, coordinate.y, z - 5, audioBufferIndex );\n                var sub3 = addCircleSegment( co.x, co.y, z - 5, audioBufferIndex );\n\n                var sub4 = addCircleSegment( coordinate.x, coordinate.y, z, audioBufferIndex );\n                var sub5 = addCircleSegment( co.x, co.y, z, audioBufferIndex );\n                var sub6 = addCircleSegment( coordinate.x, coordinate.y, z - 5, audioBufferIndex );\n                var sub7 = addCircleSegment( co.x, co.y, z - 5, audioBufferIndex );\n\n                sub1.index = co.index;\n                sub2.index = coordinate.index;\n                sub3.index = co.index;\n\n                sub4.index = coordinate.index;\n                sub5.index = co.index;\n                sub6.index = coordinate.index;\n                sub7.index = co.index;\n\n                circleSegmentOutside.subs = [];\n                circleSegmentOutside.subs.push( sub1, sub2, sub3, sub4, sub5, sub6, sub7 );\n\n                //audioBufferIndex = Math.floor( Math.random() * audioBufferIndexMax ) + audioBufferIndexMin;\n\n                if ( i < l - 1 ) {\n\n                    audioBufferIndex = Math.floor( Math.random() * audioBufferIndexMax ) + audioBufferIndexMin;\n\n                } else {\n\n                    audioBufferIndex = circleObj.segmentsOutside[ 0 ].audioBufferIndex;\n\n                }\n\n                circleObj.segmentsOutside.push( circleSegmentOutside );\n\n            } else {\n\n                circleObj.segmentsOutside.push( { active:false } );\n\n            }\n\n        }\n\n        circleHolder.push( circleObj );\n\n    }\n\n};\n\n//---\n\nfunction onResize(){\n\n    w = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n    h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n\n    canvas.width = w;\n    canvas.height = h;\n\n    context.fillStyle = '#000000';\n    context.fillRect( 0, 0, w, h );\n\n    imageData = context.getImageData( 0, 0, w, h );\n    data = imageData.data;\n\n};\n\n//---\n\nfunction audioBtHandler( event ) {\n\n    if ( audio.paused ) {\n\n        audio.play();\n\n        btStart.innerHTML = 'Pause Audio';\n\n    } else {\n\n        audio.pause();\n\n        btStart.innerHTML = 'Play Audio';\n\n    }\n\n};\n\n//---\n\nfunction mouseDownHandler( event ) {\n\n    mouseDown = true;\n\n};\n\nfunction mouseUpHandler( event ) {\n\n    mouseDown = false;\n\n};\n\nfunction mouseEnterHandler( event ) {\n\n    mouseActive = true;\n\n};\n\nfunction mouseLeaveHandler( event ) {\n\n    mouseActive = false;\n\n    //mousePos.x = w / 2;\n    //mousePos.y = h / 2;\n\n    mouseDown = false;\n\n};\n\nfunction mouseMoveHandler( event ) {\n\n    mousePos = getMousePos( canvas, event );\n\n};\n\nfunction getMousePos( canvas, event ) {\n\n    var rect = canvas.getBoundingClientRect();\n\n    return { x:event.clientX - rect.left, y:event.clientY - rect.top };\n\n};\n\n//---\n\nfunction render() {\n\n    var aa = false;\n\n    if ( analyser ) {\n\n        aa = true;\n\n    }\n\n    var frequencySource;\n\n    if ( aa === true ) {\n\n        frequencySource = new Uint8Array( analyser.frequencyBinCount );\n\n        analyser.getByteFrequencyData( frequencySource );\n\n    }\n\n    //---\n\n    var sortArray = false;\n\n    //---\n\n    var col = getRGBColor2( rgb );\n    var col2 = getRGBColor( rgb2 );\n\n    limitRGBColor( col, 0.45 );\n    limitRGBColor( col2, 0.25 );\n\n    //---\n\n    for ( var i = 0, l = circleHolder.length; i < l; i++ ) {\n\n        var circleObj = circleHolder[ i ];\n\n        circleObj.color.r = col.r - ( circleObj.z + fov ) / fov;\n        circleObj.color.g = col.g - ( circleObj.z + fov ) / fov;\n        circleObj.color.b = col.b - ( circleObj.z + fov ) / fov;\n\n        //circleObj.color.r = Math.floor( ( ( ( col.r - circleObj.z + fov ) ) + ( col2.r - circleObj.z + fov ) ) / 2 );\n        //circleObj.color.g = Math.floor( ( ( ( col.g - circleObj.z + fov ) ) + ( col2.g - circleObj.z + fov ) ) / 2 );\n        //circleObj.color.b = Math.floor( ( ( ( col.b - circleObj.z + fov ) ) + ( col2.b - circleObj.z + fov ) ) / 2 );\n\n\n        if ( circleObj.color.r < col2.r ) {\n\n            circleObj.color.r = col2.r;\n\n        }\n\n        if ( circleObj.color.g < col2.g ) {\n\n            circleObj.color.g = col2.g;\n\n        }\n\n        if ( circleObj.color.b < col2.b ) {\n\n            circleObj.color.b = col2.b;\n\n        }\n\n\n        var circleObjBack;\n\n        if ( i > 0 ) {\n\n            circleObjBack = circleHolder[ i - 1 ];\n\n        }\n\n        //---\n\n        if ( mouseActive ) {\n\n            circleObj.mp = mousePos;\n\n        } else {\n\n            circleObj.mp.x += ( ( w / 2 ) - circleObj.mp.x ) * 0.00025;\n            circleObj.mp.y += ( ( h / 2 ) - circleObj.mp.y ) * 0.00025;\n\n        }\n\n        //circleObj.center.x = ( ( w / 2 ) - circleObj.mp.x ) * ( -i / 150 ) + w / 2;\n        //circleObj.center.y = ( ( h / 2 ) - circleObj.mp.y ) * ( -i / 150 ) + h / 2;\n\n        circleObj.center.x = ( ( w / 2 ) - circleObj.mp.x ) * ( ( circleObj.z - fov ) / 500 ) + w / 2;\n        circleObj.center.y = ( ( h / 2 ) - circleObj.mp.y ) * ( ( circleObj.z - fov ) / 500 ) + h / 2;\n\n        //---\n\n        if ( aa === true ) {\n\n            //var f = frequencySource[ Math.floor(circleObj.z + fov) ];\n            //var f = frequencySource[ i ];\n            //var f = frequencySource[ circleObj.audioIndex ];\n            //var fAdd = (f / 25);// * ( (circleObj.z - fov) / 200 );\n\n            //circleObj.radiusAudio = fAdd;\n\n        }\n\n        //---\n\n        for ( var j = 0, k = circleObj.segmentsOutside.length; j < k; j++ ) {\n\n            var circleSegmentOutside = circleObj.segmentsOutside[ j ];\n\n            if ( circleSegmentOutside.active === true ) {\n\n                //---\n\n                var scale = fov / ( fov + circleObj.z );\n                var scaleBack;\n\n                if ( i > 0 ) {\n\n                    scaleBack = fov / ( fov + circleObjBack.z );\n\n                }\n\n                var frequency, frequencyAdd;\n\n                circleSegmentOutside.x2d = ( circleSegmentOutside.x * scale ) + circleObj.center.x;\n                circleSegmentOutside.y2d = ( circleSegmentOutside.y * scale ) + circleObj.center.y;\n\n                //---\n\n                if ( aa === true ) {\n\n                    frequency = frequencySource[ circleSegmentOutside.audioBufferIndex ];\n                    frequencyAdd = frequency / 20;\n\n                    //---\n\n                    circleSegmentOutside.radiusAudio = circleSegmentOutside.radius - frequencyAdd;\n\n                }\n\n                //---\n\n                var lineColorValue = 0;\n\n                if ( j > 0 ) {\n\n                    if ( aa === true && audio.paused === false ) {\n\n                        lineColorValue = Math.round( i / l * ( 55 + frequency ) );//255\n\n                        if ( lineColorValue > 255 ) {\n\n                            lineColorValue = 255;\n\n                        }\n\n                    } else {\n\n                        lineColorValue = Math.round( i / l * 200 );//255\n\n                    }\n\n                }\n\n                //---\n\n                if ( i > 0 && i < l - 1 ) {\n\n                    var sub1 = circleSegmentOutside.subs[ 0 ];\n                    var sub1angle = sub1.index * ( MATHPI2 / circleSegmentOutside.segments ) + time;\n                    sub1.x2d = ( sub1.x * scale ) + circleObj.center.x;\n                    sub1.y2d = ( sub1.y * scale ) + circleObj.center.y;\n                    sub1.x = circleObj.circleCenter.x + Math.cos( sub1angle ) * circleSegmentOutside.radiusAudio;\n                    sub1.y = circleObj.circleCenter.y + Math.sin( sub1angle ) * circleSegmentOutside.radiusAudio;\n\n                    var sub2 = circleSegmentOutside.subs[ 1 ];\n                    var sub2angle = sub2.index * ( MATHPI2 / circleSegmentOutside.segments ) + time;\n                    sub2.x2d = ( sub2.x * scaleBack ) + circleObjBack.center.x;\n                    sub2.y2d = ( sub2.y * scaleBack ) + circleObjBack.center.y;\n                    sub2.x = circleObj.circleCenter.x + Math.cos( sub2angle ) * circleSegmentOutside.radiusAudio;\n                    sub2.y = circleObj.circleCenter.y + Math.sin( sub2angle ) * circleSegmentOutside.radiusAudio;\n\n                    var sub3 = circleSegmentOutside.subs[ 2 ];\n                    var sub3angle = sub3.index * ( MATHPI2 / circleSegmentOutside.segments ) + time;\n                    sub3.x2d = ( sub3.x * scaleBack ) + circleObjBack.center.x;\n                    sub3.y2d = ( sub3.y * scaleBack ) + circleObjBack.center.y;\n                    sub3.x = circleObj.circleCenter.x + Math.cos( sub3angle ) * circleSegmentOutside.radiusAudio;\n                    sub3.y = circleObj.circleCenter.y + Math.sin( sub3angle ) * circleSegmentOutside.radiusAudio;\n\n                    var sub4 = circleSegmentOutside.subs[ 3 ];\n                    var sub4angle = sub4.index * ( MATHPI2 / circleSegmentOutside.segments ) + time;\n                    sub4.x2d = ( sub4.x * scale ) + circleObj.center.x;\n                    sub4.y2d = ( sub4.y * scale ) + circleObj.center.y;\n                    sub4.x = circleObj.circleCenter.x + Math.cos( sub4angle ) * circleSegmentOutside.radius;\n                    sub4.y = circleObj.circleCenter.y + Math.sin( sub4angle ) * circleSegmentOutside.radius;\n\n                    var sub5 = circleSegmentOutside.subs[ 4 ];\n                    var sub5angle = sub5.index * ( MATHPI2 / circleSegmentOutside.segments ) + time;\n                    sub5.x2d = ( sub5.x * scale ) + circleObj.center.x;\n                    sub5.y2d = ( sub5.y * scale ) + circleObj.center.y;\n                    sub5.x = circleObj.circleCenter.x + Math.cos( sub5angle ) * circleSegmentOutside.radius;\n                    sub5.y = circleObj.circleCenter.y + Math.sin( sub5angle ) * circleSegmentOutside.radius;\n\n                    var sub6 = circleSegmentOutside.subs[ 5 ];\n                    var sub6angle = sub6.index * ( MATHPI2 / circleSegmentOutside.segments ) + time;\n                    sub6.x2d = ( sub6.x * scaleBack ) + circleObjBack.center.x;\n                    sub6.y2d = ( sub6.y * scaleBack ) + circleObjBack.center.y;\n                    sub6.x = circleObj.circleCenter.x + Math.cos( sub6angle ) * circleSegmentOutside.radius;\n                    sub6.y = circleObj.circleCenter.y + Math.sin( sub6angle ) * circleSegmentOutside.radius;\n\n                    var sub7 = circleSegmentOutside.subs[ 6 ];\n                    var sub7angle = sub7.index * ( MATHPI2 / circleSegmentOutside.segments ) + time;\n                    sub7.x2d = ( sub7.x * scaleBack ) + circleObjBack.center.x;\n                    sub7.y2d = ( sub7.y * scaleBack ) + circleObjBack.center.y;\n                    sub7.x = circleObj.circleCenter.x + Math.cos( sub7angle ) * circleSegmentOutside.radius;\n                    sub7.y = circleObj.circleCenter.y + Math.sin( sub7angle ) * circleSegmentOutside.radius;\n\n                    var p1;\n                    var p2;\n                    var p3;\n                    var p4;\n\n                    var p5 = circleSegmentOutside.subs[ 3 ];\n                    var p6 = circleSegmentOutside.subs[ 4 ];\n                    var p7 = circleSegmentOutside.subs[ 6 ];\n                    var p8 = circleSegmentOutside.subs[ 5 ];\n\n                    if ( frequencyAdd > 0 ) {\n\n                        p1 = circleSegmentOutside;\n                        p2 = circleSegmentOutside.subs[ 1 ];\n                        p3 = circleSegmentOutside.subs[ 2 ];\n                        p4 = circleSegmentOutside.subs[ 0 ];\n\n                    }\n\n                    var cr = Math.round( circleObj.color.r * lineColorValue );\n                    var cg = Math.round( circleObj.color.g * lineColorValue );\n                    var cb = Math.round( circleObj.color.b * lineColorValue );\n\n                    if ( frequencyAdd > 0 ) {\n\n                        drawLine( p1.x2d | 0, p1.y2d | 0, p2.x2d | 0, p2.y2d | 0, cr, cg, cb, 255 );\n                        drawLine( p2.x2d | 0, p2.y2d | 0, p3.x2d | 0, p3.y2d | 0, cr, cg, cb, 255 );\n                        drawLine( p3.x2d | 0, p3.y2d | 0, p4.x2d | 0, p4.y2d | 0, cr, cg, cb, 255 );\n                        drawLine( p4.x2d | 0, p4.y2d | 0, p1.x2d | 0, p1.y2d | 0, cr, cg, cb, 255 );\n\n                        drawLine( p5.x2d | 0, p5.y2d | 0, p1.x2d | 0, p1.y2d | 0, cr, cg, cb, 255 );\n                        drawLine( p6.x2d | 0, p6.y2d | 0, p4.x2d | 0, p4.y2d | 0, cr, cg, cb, 255 );\n                        drawLine( p7.x2d | 0, p7.y2d | 0, p3.x2d | 0, p3.y2d | 0, cr, cg, cb, 255 );\n                        drawLine( p8.x2d | 0, p8.y2d | 0, p2.x2d | 0, p2.y2d | 0, cr, cg, cb, 255 );\n\n                    }\n\n                    if ( circleObj.z < fov / 2 ) {\n\n                        drawLine( p5.x2d | 0, p5.y2d | 0, p6.x2d | 0, p6.y2d | 0, cr, cg, cb, 255 );\n                        drawLine( p6.x2d | 0, p6.y2d | 0, p7.x2d | 0, p7.y2d | 0, cr, cg, cb, 255 );\n                        drawLine( p7.x2d | 0, p7.y2d | 0, p8.x2d | 0, p8.y2d | 0, cr, cg, cb, 255 );\n                        drawLine( p8.x2d | 0, p8.y2d | 0, p5.x2d | 0, p5.y2d | 0, cr, cg, cb, 255 );\n\n                    }\n\n                }\n\n                //---\n\n                var circleSegmentOutsideangle;\n\n                //if ( j < k - 1 ) {\n\n                circleSegmentOutsideangle = circleSegmentOutside.index * ( MATHPI2 / circleSegmentOutside.segments ) + time;\n\n                circleSegmentOutside.x = circleObj.circleCenter.x + Math.cos( circleSegmentOutsideangle ) * circleSegmentOutside.radiusAudio;\n                circleSegmentOutside.y = circleObj.circleCenter.y + Math.sin( circleSegmentOutsideangle ) * circleSegmentOutside.radiusAudio;\n\n                /*} else {\n\n                  var circleSegmentOutside1 = circleObj.segmentsOutside[ 0 ];\n\n                  circleSegmentOutsideangle = circleSegmentOutside1.index * ( MATHPI2 / circleSegmentOutside1.segments ) + time;\n\n                  circleSegmentOutside.x = circleObj.circleCenter.x + Math.cos( circleSegmentOutsideangle ) * circleSegmentOutside1.radiusAudio;\n                  circleSegmentOutside.y = circleObj.circleCenter.y + Math.sin( circleSegmentOutsideangle ) * circleSegmentOutside1.radiusAudio;\n\n                   }\n                */\n\n\n\n\n                //---\n                /*\n              if ( i > 0 && i < l - 1 ) {\n              //if ( i > 0 && i < l - 1 && j < k - 1 ) {\n\n                var circleSegmentOutsideLineBack;// = circleObjBack[ j ];\n                var circleSegmentInsideLineBack;\n\n                //if ( j === 0 ) {\n\n                  //pB = circleObjBack.segments[ circleObjBack.segments.length - 1 ];\n\n                //} else {\n\n                  //pB = circleObjBack.segments[ j - 1 ];\n\n                //}\n\n                circleSegmentOutsideLineBack = circleObjBack.segmentsOutside[ j ];\n                circleSegmentInsideLineBack = circleObjBack.segmentsInside[ j ];\n\n                //drawLine( circleSegmentOutside.x2d | 0, circleSegmentOutside.y2d | 0, circleSegmentOutsideLineBack.x2d | 0, circleSegmentOutsideLineBack.y2d | 0, 0, Math.round( lineColorValue / 2 ), lineColorValue, 255 );\n                //drawLine( circleSegmentInside.x2d | 0, circleSegmentInside.y2d | 0, circleSegmentInsideLineBack.x2d | 0, circleSegmentInsideLineBack.y2d | 0, 0, Math.round( lineColorValue / 2 ), lineColorValue, 255 );\n\n              }\n              */\n\n\n            }\n\n        }\n\n        if ( mouseDown ) {\n\n            circleObj.z += speed;\n\n            if ( circleObj.z > fov ) {\n\n                circleObj.z -= ( fov * 2 );\n\n                sortArray = true;\n\n            }\n\n        } else {\n\n            circleObj.z -= speed;\n\n            if ( circleObj.z < -fov ) {\n\n                circleObj.z += ( fov * 2 );\n\n                sortArray = true;\n\n            }\n\n        }\n\n    }\n\n    //---\n\n    if ( sortArray ) {\n\n        circleHolder = circleHolder.sort( function( a, b ) {\n\n            return ( b.z - a.z );\n\n        } );\n\n    }\n\n    //---\n\n    if ( mouseDown ) {\n\n        time -= 0.005;\n\n    } else {\n\n        time += 0.005;\n\n    }\n\n    //---\n\n    //soft invert colors\n    if ( mouseDown ) {\n\n        if ( colorInvertValue < 255 )\n            colorInvertValue += 5;\n        else\n            colorInvertValue = 255;\n\n        softInvert( colorInvertValue );\n\n    } else {\n\n        if ( colorInvertValue > 0 )\n            colorInvertValue -= 5;\n        else\n            colorInvertValue = 0;\n\n        if ( colorInvertValue > 0 )\n            softInvert( colorInvertValue );\n\n    }\n\n};\n\n//---\n\nfunction softInvert( value ) {\n\n    for ( var j = 0, n = data.length; j < n; j += 4 ) {\n\n        data[ j ]     = Math.abs( value - data[ j ] );     // red\n        data[ j + 1 ] = Math.abs( value - data[ j + 1 ] ); // green\n        data[ j + 2 ] = Math.abs( value - data[ j + 2 ] ); // blue\n        data[ j + 3 ] = 255;// - data[ j + 3 ]; // alpha\n\n    }\n\n};\n\n//---\n\nfunction animate() {\n\n    clearImageData();\n\n    render();\n\n    context.putImageData( imageData, 0, 0 );\n\n    requestAnimationFrame( animate );\n\n};\n\nwindow.requestAnimFrame = ( function() {\n\n    return  window.requestAnimationFrame       ||\n        window.webkitRequestAnimationFrame ||\n        window.mozRequestAnimationFrame    ||\n        function( callback ) {\n            window.setTimeout( callback, 1000 / 60 );\n        };\n\n} )();\n\n\n\n"]},"metadata":{},"sourceType":"module"}